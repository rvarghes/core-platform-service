<?xml version="1.0" encoding="UTF-8"?>
	<!--
		Designed and generated by Altova StyleVision Enterprise Edition 2010
		rel. 3 - see http://www.altova.com/stylevision for more information.
	-->
<xsl:stylesheet version="1.0"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:clitype="clitype"
	xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:iso4217="http://www.xbrl.org/2003/iso4217"
	xmlns:ix="http://www.xbrl.org/2008/inlineXBRL" xmlns:java="java"
	xmlns:link="http://www.xbrl.org/2003/linkbase" xmlns:xbrldi="http://xbrl.org/2006/xbrldi"
	xmlns:xbrli="http://www.xbrl.org/2003/instance" xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:altova="http://www.altova.com"
	exclude-result-prefixes="clitype fn iso4217 ix java link xbrldi xbrli xlink xs xsi altova">
	<xsl:output version="4.0" method="html" indent="no"
		encoding="UTF-8" doctype-public="-//W3C//DTD HTML 4.01 Transitional//EN"
		doctype-system="http://www.w3.org/TR/html4/loose.dtd" />
	<xsl:param name="SV_OutputFormat" select="'HTML'" />
	<xsl:variable name="XML" select="/" />
	<xsl:variable name="packages" select="/Itinerary/packages" />
	<xsl:variable name="flights" select="/Itinerary/flights" />
	<xsl:variable name="hotels" select="/Itinerary/hotels" />
	<xsl:variable name="insurances" select="/Itinerary/insurances" />
	<xsl:variable name="services" select="/Itinerary/services" />
	<xsl:variable name="smallcase" select="'abcdefghijklmnopqrstuvwxyz'" />
	<xsl:variable name="uppercase" select="'ABCDEFGHIJKLMNOPQRSTUVWXYZ'" />
	<xsl:variable name="packageFlightsExists">
		<xsl:call-template name="checkPackageFlightsExists"/>
	</xsl:variable>	
	<xsl:variable name="packageHotelsExists">
		<xsl:call-template name="checkPackageHotelsExists"/>
	</xsl:variable>
	<xsl:variable name="flightsExists">
		<xsl:call-template name="checkFlightsExists"/>
	</xsl:variable>							
	<xsl:variable name="hotelsExists">
		<xsl:call-template name="checkHotelsExists"/>
	</xsl:variable>		
	<xsl:template match="/">
		<html>
			<head>
				<title>
					<xsl:text> </xsl:text>
				</title>
				<meta http-equiv="X-UA-Compatible" content="IE=7" />
				<xsl:comment>[if
					IE]&gt;&lt;STYLE type=&quot;text/css&quot;&gt;.altova-rotate-left-textbox{filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3)} .altova-rotate-right-textbox{filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1)} &lt;/STYLE&gt;&lt;![endif]</xsl:comment>
				<xsl:comment>[if !IE]&gt;</xsl:comment>
				<style type="text/css">.altova-rotate-left-textbox{-webkit-transform: rotate(-90deg) translate(-100%, 0%); -webkit-transform-origin: 0% 0%;-moz-transform: rotate(-90deg) translate(-100%, 0%); -moz-transform-origin: 0% 0%}.altova-rotate-right-textbox{-webkit-transform: rotate(90deg) translate(0%, -100%); -webkit-transform-origin: 0% 0%;-moz-transform: rotate(90deg) translate(0%, -100%); -moz-transform-origin: 0% 0%}</style>
				<xsl:comment>&lt;![endif]</xsl:comment>
				<style type="text/css">@page { margin-left:0.60in; margin-right:0.60in; margin-top:0.79in; margin-bottom:0.79in } @media print { br.altova-page-break { page-break-before: always; } }</style>
			</head>
			<body>
				<table style="background-color:#ffffff; border-bottom:#a0a0a4 2px solid; border-left:#a0a0a4 2px solid; border-right:#a0a0a4 2px solid; border-top:#a0a0a4 2px solid; font-family:arial , helvetica , sans-serif; font-size:12px; " border="0" cellPadding="10" cellSpacing="0" width="675">
					<xsl:variable name="altova:CurrContextGrid_0932FC38" select="."/>
					<tbody>
						<tr style="height:72px; ">
							<td style="width:487px; " vAlign="top">
								<table border="0" cellPadding="0" cellSpacing="0" width="473">
									<xsl:variable name="altova:CurrContextGrid_0932FDB8" select="."/>
									<tbody>
										<tr style="height:29px; ">
											<td style="width:473px; ">
												<img>
													<xsl:attribute name="src">
															<xsl:text>http://www.applevacations.com/appleweb/images/abe/avlogo.gif</xsl:text>
													</xsl:attribute>
													<xsl:attribute name="alt"/>
												</img>
											</td>
										</tr>
										<tr style="height:23px; ">
											<td style="color:#005e9d; font-size:14px; padding-left:10px; width:473px; ">
												<xsl:value-of select="/Itinerary/bookingHeader/agency/name"/>
											</td>
										</tr>
										<tr style="height:15px; ">
											<td style="color:#005e9d; font-size:10px; padding-left:10px; width:473px; ">
												<xsl:value-of select="/Itinerary/bookingHeader/agency/street"/>
											</td>
										</tr>	
										<tr style="height:15px; ">
											<td style="color:#005e9d; font-size:10px; padding-left:10px; width:473px; ">
												<xsl:value-of select="/Itinerary/bookingHeader/agency/city"/>
											</td>
										</tr>	
										<tr style="height:15px; ">
											<td style="color:#005e9d; font-size:10px; padding-left:10px; width:473px; ">
												<xsl:value-of select="/Itinerary/bookingHeader/agency/state"/>
												<span>
													<xsl:text>  </xsl:text>
												</span>
												<xsl:value-of select="/Itinerary/bookingHeader/agency/zipCode"/>
											</td>
										</tr>	
										<tr style="height:15px; ">
											<td style="color:#005e9d; font-size:10px; padding-left:10px; width:473px; ">
												<xsl:value-of select="/Itinerary/bookingHeader/agency/primaryPhone"/>
											</td>
										</tr>	
									</tbody>
								</table>
							</td>
							<td style="color:#005e9d; font-size:12px; text-align:right; width:300px; " vAlign="top">
								<span>
									Quote #<xsl:value-of select="/Itinerary/quoteNo"/>
								</span>							
							</td>
						</tr>																
						<tr>
							<td colspan="2" style="width:487px; ">
								<table style="font-size:12px" border="0" cellPadding="0" cellSpacing="0" width="675">
									<xsl:variable name="altova:CurrContextGrid_09330118" select="."/>
									<tbody>
										<tr>
											<td style="padding-left:10px; width:389px; " vAlign="top">
												<br/>
												<span style="font-size:14px;">
													<xsl:value-of select="/Itinerary/CustomMessages/OpeningMessage"/>
												</span>
												<br/>
												<xsl:value-of select="/Itinerary/CustomMessages/OpeningMesgText"/>
											</td>
											<td style="width:286px; " align="right">
												<table style="background-color:#f5f5f5; border-bottom:#a0a0a4 1px solid; border-left:#a0a0a4 1px solid; border-right:#a0a0a4 1px solid; border-top:#a0a0a4 1px solid; font-size:14px; " align="right" border="0" cellPadding="2" cellSpacing="2" width="270">
													<tbody>	
													
													<xsl:choose>
														<xsl:when test="($flightsExists='true' and $packageFlightsExists='false')or($hotelsExists='true' and $packageHotelsExists='false')">
															<xsl:if test="(count(/Itinerary/flights/TripFlight) = 1)or(count(/Itinerary/hotels/Hotel) = 1)">	
															<tr style="font-weight:bold; ">
															<td style="width:260px; " align="center">
																<span>
																	<xsl:text>Total Price: $</xsl:text>
																</span>
																<xsl:call-template name="format-price">
																	<xsl:with-param name="price">
																		<xsl:value-of select="/Itinerary/itineraryPrice/totalPrice"/>
																	</xsl:with-param>
																</xsl:call-template>																
															</td>
															</tr>
															</xsl:if>
														</xsl:when>
														<xsl:when test="($flightsExists='false' and $packageFlightsExists='true') and ($hotelsExists='false' and $packageHotelsExists='true')">
															<xsl:if test="count(/Itinerary/packages/Package) = 1">	
																<tr style="font-weight:bold; ">
																<td style="width:260px; " align="center">
																	<span>
																		<xsl:text>Total Price: $</xsl:text>
																	</span>
																	<xsl:call-template name="format-price">
																		<xsl:with-param name="price">
																			<xsl:value-of select="/Itinerary/itineraryPrice/totalPrice"/>
																		</xsl:with-param>
																	</xsl:call-template>																
																</td>
																</tr>
															</xsl:if>														
														</xsl:when>																											
													</xsl:choose>																																																																								
														<tr style="font-weight:bold; ">
															<td style="width:260px; " align="center">
																<span>
																	<xsl:text>Call </xsl:text>
																</span>
																<xsl:value-of select="/Itinerary/bookingHeader/agency/primaryPhone"/>
																<span>
																	<xsl:text> to Book Now</xsl:text>
																</span>
															</td>
														</tr>
													</tbody>
												</table>
											</td>
										</tr>										
									</tbody>
								</table>
								<br/>														
							<xsl:if test="$flightsExists='true'">								
								<xsl:for-each select="/Itinerary/flights/TripFlight">								
									<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
									<tbody>
										<tr>
											<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
												<span style="font-weight:bold; ">
													<xsl:text>Your Flights</xsl:text> 
													<xsl:if test="count(/Itinerary/flights/TripFlight) > 1 ">
														Option <xsl:value-of select="position()"/>
													</xsl:if>
												</span>
											</td>
										</tr>
									</tbody>
								</table>
								<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
									<tbody>
										<tr style="background-color:#cacaca; font-weight:bold; ">
											<td style="width:88px; " align="center">
												<span>
													<xsl:text>Type</xsl:text>
												</span>
											</td>
											<td style="width:77px; " align="center">
												<span>
													<xsl:text>Passenger(s)</xsl:text>
												</span>
											</td>
											<td style="width:97px; ">						
												<span>
													<xsl:text>Flight</xsl:text>
												</span>
											</td>
											
											<td style="width:120px; ">
												<span>
													<xsl:text>Depart</xsl:text>
												</span>
											</td>
											<td style="width:120px; ">
												<span>
													<xsl:text>Arrive</xsl:text>
												</span>
											</td>
											<td style="width:65px; " align="center">
												<span>
													<xsl:text>Fare Class</xsl:text>
												</span>
											</td>											
										</tr>
									</tbody>
								</table>									
								<xsl:call-template name="displayFlightDetails">
									<xsl:with-param name="tripFlight" select="."/>
								</xsl:call-template>
								<table style="font-size:12px; color:#C00000;" border="0" cellPadding="2" cellSpacing="2" width="675">
								<tbody>
								<tr>
								<td>				
									<a style="font-weight:bold;" target="_blank">
										<xsl:attribute name="href">
											<xsl:text>http://www.book.applevacations.com/showTravelInfo.do?command=showAirlineDetails</xsl:text>
										</xsl:attribute>
										<xsl:text>Click Here for Air Carrier Baggage Policies</xsl:text>
									</a>
									<span style="color:#C00000;">
									<xsl:text> or go to http://www.book.applevacations.com/showTravelInfo.do?command=showAirlineDetails</xsl:text>						
									</span>								
								</td>		
								</tr>
								</tbody>
								</table>
								<br/>
								<xsl:if test="count(/Itinerary/flights/TripFlight) > 1">	
									<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
									<xsl:variable name="altova:CurrContextGrid_093439B8" select="."/>
									<tbody>
										<tr>
											<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
												<span style="font-weight:bold; ">
													<xsl:text>Price Breakdown Option </xsl:text>
													<xsl:value-of select="position()"/>
												</span>
											</td>
										</tr>
									</tbody>
									</table>
									<br/>
									<table style="font-size:12px" border="0" cellPadding="0" cellSpacing="0" width="675">
										<tbody>
											<tr align="left">
												<td style="width:8px; " align="left">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; " align="left">
													<span>
														<xsl:text>Base Price</xsl:text>
													</span>
												</td>
												<td style="width:10px; " align="left">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; " align="left">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:call-template name="format-price">
														<xsl:with-param name="price">
															<xsl:value-of select="price/occpancyBasedPrice - (price/totalTax + price/promoSavings)"/>
														</xsl:with-param>
													</xsl:call-template>
												</td>											
												<td rowspan="5" style="width:319px; " align="right">
												  <table style="background-color:#f5f5f5; border-bottom:#a0a0a4 1px solid; border-left:#a0a0a4 1px solid; border-right:#a0a0a4 1px solid; border-top:#a0a0a4 1px solid; font-size:14px; " align="right" border="0" cellPadding="2" cellSpacing="2" width="270">
														<xsl:variable name="altova:CurrContextGrid_093571D0" select="."/>
														<tbody>
															<tr style="font-weight:bold; ">
																<td style="width:278px; " align="center">
																	<span>
																		<xsl:text>Total Price: $</xsl:text>
																	</span>
																	<xsl:call-template name="format-price">
																		<xsl:with-param name="price">
																			<xsl:value-of select="price/occpancyBasedPrice"/>
																		</xsl:with-param>
																	</xsl:call-template>
																</td>
															</tr>
															
															<tr style="font-weight:bold; ">
																<td style="width:278px; " align="center">
																	<span>
																		<xsl:text>Call&#160; </xsl:text>
																	</span>
																	<xsl:value-of select="/Itinerary/bookingHeader/agency/primaryPhone"/>
																	<span>
																		<xsl:text> to Book Now</xsl:text>
																	</span>
																</td>
															</tr>
														</tbody>
													</table>
												</td>
											</tr>
											<tr>
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text>Commission</xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:call-template name="format-price">
														<xsl:with-param name="price">
															<xsl:value-of select="price/commissionAmount"/>
														</xsl:with-param>
													</xsl:call-template>																
												</td>
											</tr>										
											<tr>
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text>Taxes</xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:call-template name="format-price">
														<xsl:with-param name="price">
															<xsl:value-of select="price/totalTax"/>
														</xsl:with-param>
													</xsl:call-template>
												</td>
											</tr>
											<tr style="height:15px; ">
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text>Total Price</xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:call-template name="format-price">
														<xsl:with-param name="price">
															<xsl:value-of select="price/occpancyBasedPrice"/>
														</xsl:with-param>
													</xsl:call-template>
												</td>
											</tr>
	<!-- 										
											<tr style="height:15px; ">
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text>Deposit Due</xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:for-each select="$XML">
														<xsl:for-each select="Itinerary">
															<xsl:for-each select="bookingHeader">
																<xsl:for-each select="amountDue">
																	<xsl:apply-templates/>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</td>
											</tr>
	-->										
											<tr style="height:15px; ">
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
											</tr>
											<tr style="height:15px; ">
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
											</tr>
										</tbody>
									</table>
								</xsl:if>											
								</xsl:for-each>								
							</xsl:if>		
							<br/>											
				<xsl:if test="$hotelsExists='true'">
				<xsl:for-each select="/Itinerary/hotels/Hotel">
					<xsl:if test="preselectedRooms or selectedRooms">
					<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
						<tbody>
							<tr>
								<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
									<span style="font-weight:bold; ">
										<xsl:text>Your Hotel </xsl:text>
									</span>
									<span>
										<xsl:text>(per room) </xsl:text>
										<xsl:if test="count(/Itinerary/hotels/Hotel) > 1 ">
										Option <xsl:value-of select="position()"/>
										</xsl:if>
									</span>
								</td>
							</tr>
						</tbody>
					</table>
					<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
						<tbody>
							<tr style="background-color:#cacaca; font-weight:bold; ">
								<td style="width:90px; " align="center">
									<span>
										<xsl:text>Passenger(s)</xsl:text>
									</span>
								</td>
								<td style="width:238px; ">
									<span>
										<xsl:text>Hotel</xsl:text>
									</span>
								</td>
								<td style="width:70px; ">
									<span>
										<xsl:text>Nights</xsl:text>
									</span>
								</td>								
								<td style="width:169px; " align="center">
									<span>
										<xsl:text>Room Type</xsl:text>
									</span>
								</td>
								<td style="width:110px; ">
									<span>
										<xsl:text>Check-in</xsl:text>
									</span>
								</td>
								<td style="width:110px; ">
									<span>
										<xsl:text>Check-out</xsl:text>
									</span>
								</td>
								<td style="width:110px; ">
									<span>
										<xsl:text>Meal Type</xsl:text>
									</span>
								</td>
							</tr>
						</tbody>														
							
						<xsl:call-template name="displayHotel">
							<xsl:with-param name="hotel" select="."/>
						</xsl:call-template>																							
					</table>
					<xsl:if test="count(/Itinerary/hotels/Hotel) > 1">	
							<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
							<xsl:variable name="altova:CurrContextGrid_093439B8" select="."/>
							<tbody>
								<tr>
									<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
										<span style="font-weight:bold; ">
											<xsl:text>Price Breakdown Option </xsl:text>
											<xsl:value-of select="position()"/>
										</span>
									</td>
								</tr>
							</tbody>
							</table>
							<br/>
							<table style="font-size:12px" border="0" cellPadding="0" cellSpacing="0" width="675">
								<tbody>
									<tr align="left">
										<td style="width:8px; " align="left">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:99px; " align="left">
											<span>
												<xsl:text>Base Price</xsl:text>
											</span>
										</td>
										<td style="width:10px; " align="left">
											<span>
												<xsl:text>:</xsl:text>
											</span>
										</td>
										<td style="width:239px; " align="left">
											<span>
												<xsl:text>$</xsl:text>
											</span>
											<xsl:call-template name="format-price">
												<xsl:with-param name="price">
													<xsl:value-of select="displayRoomCategory/displayRoomPrice/totalAmount - (displayRoomCategory/displayRoomPrice/tax + displayRoomCategory/displayRoomPrice/promoSavingsAmount)"/>
												</xsl:with-param>
											</xsl:call-template>
										</td>											
										<td rowspan="5" style="width:319px; " align="right">
										  <table style="background-color:#f5f5f5; border-bottom:#a0a0a4 1px solid; border-left:#a0a0a4 1px solid; border-right:#a0a0a4 1px solid; border-top:#a0a0a4 1px solid; font-size:14px; " align="right" border="0" cellPadding="2" cellSpacing="2" width="270">
												<xsl:variable name="altova:CurrContextGrid_093571D0" select="."/>
												<tbody>
													<tr style="font-weight:bold; ">
														<td style="width:278px; " align="center">
															<span>
																<xsl:text>Total Price: $</xsl:text>
															</span>
															<xsl:call-template name="format-price">
																<xsl:with-param name="price">
																	<xsl:value-of select="displayRoomCategory/displayRoomPrice/totalAmount"/>
																</xsl:with-param>
															</xsl:call-template>
														</td>
													</tr>
													
													<tr style="font-weight:bold; ">
														<td style="width:278px; " align="center">
															<span>
																<xsl:text>Call&#160; </xsl:text>
															</span>
															<xsl:value-of select="/Itinerary/bookingHeader/agency/primaryPhone"/>
															<span>
																<xsl:text> to Book Now</xsl:text>
															</span>
														</td>
													</tr>
												</tbody>
											</table>
										</td>
									</tr>
									<tr>
										<td style="width:8px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:99px; ">
											<span>
												<xsl:text>Commission</xsl:text>
											</span>
										</td>
										<td style="width:10px; ">
											<span>
												<xsl:text>:</xsl:text>
											</span>
										</td>
										<td style="width:239px; ">
											<span>
												<xsl:text>$</xsl:text>
											</span>
											<xsl:call-template name="format-price">
												<xsl:with-param name="price">
													<xsl:value-of select="displayRoomCategory/displayRoomPrice/commissionAmount"/>
												</xsl:with-param>
											</xsl:call-template>																
										</td>
									</tr>										
									<tr>
										<td style="width:8px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:99px; ">
											<span>
												<xsl:text>Taxes</xsl:text>
											</span>
										</td>
										<td style="width:10px; ">
											<span>
												<xsl:text>:</xsl:text>
											</span>
										</td>
										<td style="width:239px; ">
											<span>
												<xsl:text>$</xsl:text>
											</span>
											<xsl:call-template name="format-price">
												<xsl:with-param name="price">
													<xsl:value-of select="displayRoomCategory/displayRoomPrice/tax"/>
												</xsl:with-param>
											</xsl:call-template>
										</td>
									</tr>
									<tr style="height:15px; ">
										<td style="width:8px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:99px; ">
											<span>
												<xsl:text>Total Price</xsl:text>
											</span>
										</td>
										<td style="width:10px; ">
											<span>
												<xsl:text>:</xsl:text>
											</span>
										</td>
										<td style="width:239px; ">
											<span>
												<xsl:text>$</xsl:text>
											</span>
											<xsl:call-template name="format-price">
												<xsl:with-param name="price">
													<xsl:value-of select="displayRoomCategory/displayRoomPrice/totalAmount"/>
												</xsl:with-param>
											</xsl:call-template>
										</td>
									</tr>
			<!-- 										
									<tr style="height:15px; ">
										<td style="width:8px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:99px; ">
											<span>
												<xsl:text>Deposit Due</xsl:text>
											</span>
										</td>
										<td style="width:10px; ">
											<span>
												<xsl:text>:</xsl:text>
											</span>
										</td>
										<td style="width:239px; ">
											<span>
												<xsl:text>$</xsl:text>
											</span>
											<xsl:for-each select="$XML">
												<xsl:for-each select="Itinerary">
													<xsl:for-each select="bookingHeader">
														<xsl:for-each select="amountDue">
															<xsl:apply-templates/>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</td>
									</tr>
			-->										
									<tr style="height:15px; ">
										<td style="width:8px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:99px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:10px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:239px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
									</tr>
									<tr style="height:15px; ">
										<td style="width:8px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:99px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:10px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
										<td style="width:239px; ">
											<span>
												<xsl:text> </xsl:text>
											</span>
										</td>
									</tr>
								</tbody>
							</table>
						</xsl:if>
					</xsl:if>
					</xsl:for-each>				
					<br/>					
				</xsl:if>		
				<xsl:for-each select="/Itinerary/packages/Package">				 											
				<xsl:if test="$packageFlightsExists='true'">
				
					<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
						<tbody>
							<tr>
								<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
									<span style="font-weight:bold; ">
										<xsl:text>Your Flights for </xsl:text> <xsl:value-of select="selectedFlight/outboundFlight/gateway"/>/<xsl:value-of select="selectedFlight/outboundFlight/destination"/>
										<xsl:text> </xsl:text>
										<xsl:call-template name="FormatDateMMDD">
											<xsl:with-param name="DateTime" select="selectedHotel/checkInDate"/>
										</xsl:call-template>-
										<xsl:call-template name="FormatDateMMDD">
											<xsl:with-param name="DateTime" select="selectedHotel/checkOutDate"/>
										</xsl:call-template>
										<xsl:text> </xsl:text> 
										<xsl:value-of select="selectedHotel/noOfNights"/> Nights 
										<xsl:if test="count(/Itinerary/packages/Package) > 1 ">
											Option <xsl:value-of select="position()"/>
										</xsl:if>
									</span>									
								</td>
							</tr>
						</tbody>
					</table>
					<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
						<tbody>
							<tr style="background-color:#cacaca; font-weight:bold; ">
								<td style="width:88px; " align="center">
									<span>
										<xsl:text>Type</xsl:text>
									</span>
								</td>
								<td style="width:77px; " align="center">
									<span>
										<xsl:text>Passenger(s)</xsl:text>
									</span>
								</td>
								<td style="width:97px; ">						
									<span>
										<xsl:text>Flight</xsl:text>
									</span>
								</td>
								
								<td style="width:120px; ">
									<span>
										<xsl:text>Depart</xsl:text>
									</span>
								</td>
								<td style="width:120px; ">
									<span>
										<xsl:text>Arrive</xsl:text>
									</span>
								</td>
								<td style="width:65px; " align="center">
									<span>
										<xsl:text>Fare Class</xsl:text>
									</span>
								</td>											
							</tr>
						</tbody>
					</table>
					<xsl:if test="selectedFlight">
						<xsl:call-template name="displayPackageFlightDetails">
							<xsl:with-param name="tripFlight" select="selectedFlight"/>
						</xsl:call-template>											
					</xsl:if>
					<table style="font-size:12px; color:#C00000;" border="0" cellPadding="2" cellSpacing="2" width="675">
					<tbody>
					<tr>
					<td>				
						<a style="font-weight:bold;" target="_blank">
							<xsl:attribute name="href">
								<xsl:text>http://www.book.applevacations.com/showTravelInfo.do?command=showAirlineDetails</xsl:text>
							</xsl:attribute>
							<xsl:text>Click Here for Air Carrier Baggage Policies</xsl:text>
						</a>
						<span style="color:#C00000;">
							<xsl:text> or go to http://www.book.applevacations.com/showTravelInfo.do?command=showAirlineDetails</xsl:text>						
						</span>						
					</td>		
					</tr>
					</tbody>
					</table>				 	
				</xsl:if>
				<xsl:if test="$packageHotelsExists='true'">				
					<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
						<tbody>
							<tr>
								<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
									<span style="font-weight:bold; ">
										<xsl:text>Your Hotel</xsl:text>
										<xsl:text>(per room) for </xsl:text><xsl:value-of select="selectedHotel/originLocation"/>/<xsl:value-of select="selectedHotel/hotelCityCode"/>
										<xsl:text> </xsl:text>
										<xsl:call-template name="FormatDateMMDD">
											<xsl:with-param name="DateTime" select="selectedHotel/checkInDate"/>
										</xsl:call-template>-
										<xsl:call-template name="FormatDateMMDD">
											<xsl:with-param name="DateTime" select="selectedHotel/checkOutDate"/>
										</xsl:call-template>
										<xsl:text> </xsl:text> 
										<xsl:value-of select="selectedHotel/noOfNights"/> Nights  
										<xsl:if test="count(/Itinerary/packages/Package) > 1 ">
											Option <xsl:value-of select="position()"/>
										</xsl:if>
									</span>
								</td>
							</tr>
						</tbody>
					</table>
					<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
						<tbody>
							<tr style="background-color:#cacaca; font-weight:bold; ">
								<td style="width:90px; " align="center">
									<span>
										<xsl:text>Passenger(s)</xsl:text>
									</span>
								</td>
								<td style="width:238px; ">
									<span>
										<xsl:text>Hotel</xsl:text>
									</span>
								</td>
								<td style="width:70px; ">
									<span>
										<xsl:text>Nights</xsl:text>
									</span>
								</td>								
								<td style="width:169px; " align="center">
									<span>
										<xsl:text>Room Type</xsl:text>
									</span>
								</td>
								<td style="width:110px; ">
									<span>
										<xsl:text>Check-in</xsl:text>
									</span>
								</td>
								<td style="width:110px; ">
									<span>
										<xsl:text>Check-out</xsl:text>
									</span>
								</td>
								<td style="width:110px; ">
									<span>
										<xsl:text>Meal Type</xsl:text>
									</span>
								</td>
							</tr>							
							<xsl:if test="selectedHotel">
								<xsl:call-template name="displayPackageHotel">
									<xsl:with-param name="hotel" select="selectedHotel"/>
								</xsl:call-template>											
							</xsl:if>
													
						</tbody>
					</table>				
					<br/>
						
					<xsl:if test="selectedHotel/preselectedRooms/object-array/RoomPrice or selectedHotel/selectedRooms/object-array/RoomPrice">
						<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
							<tbody>
								<tr style="background-color:#cacaca; font-weight:bold; ">
									<td style="width:70px; " align="center">
										<span>
											<xsl:text>Room</xsl:text>
										</span>
									</td>
									<td style="width:110px; ">
										<span>
											<xsl:text>Passenger Type</xsl:text>
										</span>
									</td>
									<td style="width:110px; ">
										<span>
											<xsl:text>Price per Passenger</xsl:text>
										</span>
									</td>								
									<td style="width:110px; " align="center">
										<span>
											<xsl:text>Taxes</xsl:text>
										</span>
									</td>
									<td style="width:110px; ">
										<span>
											<xsl:text>US Tax</xsl:text>
										</span>
									</td>
									<td style="width:110px; ">
										<span>
											<xsl:text>Foreign Tax</xsl:text>
										</span>
									</td>
									<td style="width:110px; ">
										<span>
											<xsl:text>Airport Fee</xsl:text>
										</span>
									</td>
									<td style="width:110px; ">
										<span>
											<xsl:text>Total Price Per Person</xsl:text>
										</span>
									</td>
									<td style="width:110px; ">
										<span>
											<xsl:text>Total Price</xsl:text>
										</span>
									</td>
								</tr>								
								<xsl:choose>
									<xsl:when test="selectedHotel/preselectedRooms/object-array/RoomPrice">
										<xsl:for-each select="selectedHotel/preselectedRooms/object-array/RoomPrice">
											<xsl:call-template name="paxRoomPriceDetails">
												<xsl:with-param name="paxRoomId" select="roomId"/>
												<xsl:with-param name="isPkgHotel" select="true()" />
												<xsl:with-param name="paxRoomPrice" select="."/>
											</xsl:call-template>								
										</xsl:for-each>
									</xsl:when>
									<xsl:when test="selectedHotel/selectedRooms/object-array/RoomPrice">
										<xsl:for-each select="selectedHotel/selectedRooms/object-array/RoomPrice">
											<xsl:call-template name="paxRoomPriceDetails">
												<xsl:with-param name="paxRoomId" select="roomId"/>
												<xsl:with-param name="isPkgHotel" select="true()" />
												<xsl:with-param name="paxRoomPrice" select="."/>
											</xsl:call-template>								
										</xsl:for-each>								
									</xsl:when>					
								</xsl:choose>
							</tbody>
						</table>				
						<br/>
					</xsl:if>
				</xsl:if>
				<xsl:if test="(count(/Itinerary/packages/Package) > 1) or ((count(/Itinerary/flights/TripFlight) >= 1)and (count(/Itinerary/packages/Package) >= 1)) or ((count(/Itinerary/hotels/Hotel) >= 1)and (count(/Itinerary/packages/Package) >= 1))">
					<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
						<xsl:variable name="altova:CurrContextGrid_093439B8" select="."/>
						<tbody>
							<tr>
								<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
									<span style="font-weight:bold; ">
										<xsl:text>Price Breakdown for </xsl:text> <xsl:value-of select="selectedHotel/originLocation"/>/<xsl:value-of select="selectedHotel/hotelCityCode"/>
										<xsl:text> </xsl:text>
										<xsl:call-template name="FormatDateMMDD">
											<xsl:with-param name="DateTime" select="selectedHotel/checkInDate"/>
										</xsl:call-template>-
										<xsl:call-template name="FormatDateMMDD">
											<xsl:with-param name="DateTime" select="selectedHotel/checkOutDate"/>
										</xsl:call-template>
										<xsl:text> </xsl:text>  
										<xsl:value-of select="selectedHotel/noOfNights"/> Nights  																				
										<xsl:if test="count(/Itinerary/packages/Package) > 1">
											Option <xsl:value-of select="position()"/>
										</xsl:if>
													
									</span>
								</td>
							</tr>
						</tbody>
					</table>
					<br/>
					<table style="font-size:12px" border="0" cellPadding="0" cellSpacing="0" width="675">
						<tbody>
							<tr align="left">
								<td style="width:8px; " align="left">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:99px; " align="left">
									<span>
										<xsl:text>Base Price</xsl:text>
									</span>
								</td>
								<td style="width:10px; " align="left">
									<span>
										<xsl:text>:</xsl:text>
									</span>
								</td>
								<td style="width:239px; " align="left">
									<span>
										<xsl:text>$</xsl:text>
									</span>
									<xsl:call-template name="format-price">
										<xsl:with-param name="price">
											<xsl:value-of select="price/basePrice"/>
										</xsl:with-param>
									</xsl:call-template>
								</td>
								<td rowspan="5" style="width:319px; " align="right">
									<table style="background-color:#f5f5f5; border-bottom:#a0a0a4 1px solid; border-left:#a0a0a4 1px solid; border-right:#a0a0a4 1px solid; border-top:#a0a0a4 1px solid; font-size:14px; " align="right" border="0" cellPadding="2" cellSpacing="2" width="270">
										<xsl:variable name="altova:CurrContextGrid_093571D0" select="."/>
										<tbody>
											<tr style="font-weight:bold; ">
												<td style="width:278px; " align="center">
													<span>
														<xsl:text>Total Price: $</xsl:text>
													</span>
													<xsl:call-template name="format-price">
														<xsl:with-param name="price">
															<xsl:value-of select="price/packagePrice"/>
														</xsl:with-param>
													</xsl:call-template>
												</td>
											</tr>
											
											<tr style="font-weight:bold; ">
												<td style="width:278px; " align="center">
													<span>
														<xsl:text>Call&#160; </xsl:text>
													</span>
													<xsl:value-of select="/Itinerary/bookingHeader/agency/primaryPhone"/>
													<span>
														<xsl:text> to Book Now</xsl:text>
													</span>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<td style="width:8px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:99px; ">
									<span>
										<xsl:text>Commission</xsl:text>
									</span>
								</td>
								<td style="width:10px; ">
									<span>
										<xsl:text>:</xsl:text>
									</span>
								</td>
								<td style="width:239px; ">
									<span>
										<xsl:text>$</xsl:text>
									</span>
									<xsl:call-template name="format-price">
										<xsl:with-param name="price">
											<xsl:value-of select="/Itinerary/bookingHeader/baseCommission"/>
										</xsl:with-param>
									</xsl:call-template>																
								</td>
							</tr>										
							<tr>
								<td style="width:8px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:99px; ">
									<span>
										<xsl:text>Taxes</xsl:text>
									</span>
								</td>
								<td style="width:10px; ">
									<span>
										<xsl:text>:</xsl:text>
									</span>
								</td>
								<td style="width:239px; ">
									<span>
										<xsl:text>$</xsl:text>
									</span>
									<xsl:call-template name="format-price">
										<xsl:with-param name="price">
											<xsl:value-of select="price/totalTax"/>
										</xsl:with-param>
									</xsl:call-template>
								</td>
							</tr>
							<tr style="height:15px; ">
								<td style="width:8px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:99px; ">
									<span>
										<xsl:text>Total Price</xsl:text>
									</span>
								</td>
								<td style="width:10px; ">
									<span>
										<xsl:text>:</xsl:text>
									</span>
								</td>
								<td style="width:239px; ">
									<span>
										<xsl:text>$</xsl:text>
									</span>
									<xsl:call-template name="format-price">
										<xsl:with-param name="price">
											<xsl:value-of select="price/packagePrice"/>
										</xsl:with-param>
									</xsl:call-template>
								</td>
							</tr>								
							<tr style="height:15px; ">
								<td style="width:8px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:99px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:10px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:239px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
							</tr>
							<tr style="height:15px; ">
								<td style="width:8px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:99px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:10px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
								<td style="width:239px; ">
									<span>
										<xsl:text> </xsl:text>
									</span>
								</td>
							</tr>
						</tbody>
					</table>
				</xsl:if>
					<br/>										
			</xsl:for-each>	
				<br/>
				<!--  for services:begin -->
				<xsl:if test="(count($services/service)>=1)">
				<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
					<xsl:variable name="altova:CurrContextGrid_09655258" select="."/>
					<tbody>
						<tr>
							<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
								<span style="font-weight:bold; ">
									<xsl:text>Apple Extras</xsl:text>
								</span>
							</td>
						</tr>
					</tbody>
				</table>
				<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
					<xsl:variable name="altova:CurrContextGrid_09654778" select="."/>
					<tbody>
						<tr style="background-color:#cacaca; font-weight:bold; ">
							<td style="width:86px; " align="center">
								<span>
									<xsl:text>Passenger(s)</xsl:text>
								</span>
							</td>
							<td style="width:264px; ">
								<span>
									<xsl:text>Apple Extra</xsl:text>
								</span>
							</td>
							<td style="width:305px; ">
								<span>
									<xsl:text>Selected Date</xsl:text>
								</span>
							</td>
						</tr>
						<xsl:for-each select="$XML">
							<xsl:for-each select="Itinerary">
								<xsl:for-each select="services">
									<xsl:for-each select="object-array">
										<xsl:for-each select="Service">
											<tr>
												<td style="text-align:center; width:86px; ">
													<xsl:for-each select="guestAllocation">
														<xsl:apply-templates/>
													</xsl:for-each>
												</td>
												<td style="width:264px; ">
													<xsl:for-each select="serviceName">
														<span style="font-weight:bold; ">
															<xsl:apply-templates/>
														</span>
													</xsl:for-each>
												</td>
												<td style="width:305px; ">
													<xsl:for-each select="selectedDate">
														<xsl:apply-templates/>
													</xsl:for-each>
												</td>
											</tr>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</tbody>
				</table>
				</xsl:if>
				<br/>
								<!-- Vehicle display -->
				<xsl:variable name="vehiclesExists">
					<xsl:call-template name="checkVehiclesExists"/>
				</xsl:variable>
				<xsl:if test="$vehiclesExists='true'">
								<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
					<tbody>
						<tr>
							<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
								<span style="font-weight:bold; ">
									<xsl:text>Car Information </xsl:text>
								</span>
							</td>
						</tr>
					</tbody>
				</table>
					<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
						<tbody>
							<tr style="background-color:#cacaca; font-weight:bold; ">
								<td style="width:86px; " align="center">
									<span>
										<xsl:text>Driver</xsl:text>
									</span>
								</td>
								<td style="width:70px; ">
									<span>
										<xsl:text>Company</xsl:text>
									</span>
								</td>
								<td style="width:188px; " align="center">
									<span>
										<xsl:text>Description</xsl:text>
									</span>
								</td>
								<td style="width:79px; ">
									<span>
										<xsl:text>Class</xsl:text>
									</span>
								</td>
								<td style="width:110px; ">
									<span>
										<xsl:text>Pick-up</xsl:text>
									</span>
								</td>
								<td style="width:110px; ">
									<span>
										<xsl:text>Drop-off</xsl:text>
									</span>
								</td>
							</tr>
							<xsl:for-each select="/Itinerary/packages/Package">
								<xsl:if test="selectedVehicle">
									<xsl:call-template name="displayVehicle">
										<xsl:with-param name="vehicle" select="selectedVehicle"/>
									</xsl:call-template>											
								</xsl:if>
							</xsl:for-each>
							<xsl:for-each select="/Itinerary/vehicles/Vehicle">
								<xsl:call-template name="displayVehicle">
									<xsl:with-param name="vehicle" select="."/>
								</xsl:call-template>											
							</xsl:for-each>
						</tbody>
					</table>				
					<br/>
				</xsl:if>				
								<!--  for services:begin -->
								<xsl:if test="(count($services/Service)>=1)">
								<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
									<tbody>
										<tr>
											<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
												<span style="font-weight:bold; ">
													<xsl:text>Apple Extras</xsl:text>
												</span>
											</td>
										</tr>
									</tbody>
								</table>
								<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
									<tbody>
										<tr style="background-color:#cacaca; font-weight:bold; ">
											<td style="width:86px; " align="center">
												<span>
													<xsl:text>Passenger(s)</xsl:text>
												</span>
											</td>
											<td style="width:264px; ">
												<span>
													<xsl:text>Apple Extra</xsl:text>
												</span>
											</td>
											<td style="width:305px; ">
												<span>
													<xsl:text>Selected Date</xsl:text>
												</span>
											</td>
										</tr>
										<xsl:for-each select="Itinerary/services/Service">
											<tr>
												<td style="text-align:center; width:86px; ">
													<xsl:value-of select="guestAllocation"/>
												</td>
												<td style="width:264px; ">
													<xsl:value-of select="serviceName"/>
												</td>
												<td style="width:305px; ">
													<xsl:call-template name="FormatDateYYYY-MM-DD">
														<xsl:with-param name="DateTime" select="selectedDate"/>
													</xsl:call-template>
												</td>
											</tr>
										</xsl:for-each>
									</tbody>
								</table>
								</xsl:if>
								<!-- for services:end-->
								<br/>
								<!--  for insurances: begin -->
								<xsl:if test="(count($insurances/Insurance)>=1)">
								<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
									<xsl:variable name="altova:CurrContextGrid_0DD36A68" select="."/>
									<tbody>
										<tr>
											<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
												<span style="font-weight:bold; ">
													<xsl:text>AVOK - Total Vacation Security</xsl:text>
												</span>
											</td>
										</tr>
									</tbody>
								</table>
								<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
									<xsl:variable name="altova:CurrContextGrid_0DD36BE8" select="."/>
									<tbody>
										<tr style="background-color:#cacaca; font-weight:bold; ">
											<td style="width:86px; " align="center">
												<span>
													<xsl:text>Passenger(s)</xsl:text>
												</span>
											</td>
											<td style="width:264px; ">
												<span>
													<xsl:text>Vacation Security Type</xsl:text>
												</span>
											</td>
											<td style="width:305px; ">
												<span>
													<xsl:text> </xsl:text>
												</span>
											</td>
										</tr>
														<xsl:for-each select="/Itinerary/insurances/Insurance">
															<tr>
																<td style="text-align:center; width:86px; ">
																	<xsl:value-of select="guestAllocation"/>
																</td>
																<td style="text-align:left; width:264px; ">
																	<xsl:value-of select="materailDesc"/>
																</td>
																<td style="text-align:center; width:305px; ">
																	<a>
																		<xsl:choose>
																			<xsl:when test="substring(string(&apos;http://www.applevacations.com/avok&apos;), 1, 1) = '#'">
																				<xsl:attribute name="href">
																					<xsl:value-of select="&apos;http://www.applevacations.com/avok&apos;"/>
																				</xsl:attribute>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:attribute name="href">
																					<xsl:if test="substring(string(&apos;http://www.applevacations.com/avok&apos;), 2, 1) = ':'">
																						<xsl:text>file:///</xsl:text>
																					</xsl:if>
																					<xsl:value-of select="translate(string(&apos;http://www.applevacations.com/avok&apos;), '&#x5c;', '/')"/>
																				</xsl:attribute>
																			</xsl:otherwise>
																		</xsl:choose>
																		<span>
																			<xsl:text>Coverage Details</xsl:text>
																		</span>
																	</a>
																</td>
															</tr>
														</xsl:for-each>
									</tbody>
								</table>
								<table align="" width="675">
										<tr>
											<td align="center" style="">
												<span style="">
													<xsl:text>Travelers should review the </xsl:text>
												</span>
												<a style="font-weight:bold;" target="_blank">

													<xsl:attribute name="href">
											<xsl:text>http://www.tripmate.com/wpA430</xsl:text>
										</xsl:attribute>
													<xsl:text>Full Details</xsl:text>
												</a>
												<span style="">
													<xsl:text> of the plan information for their state of residence before purchasing. Travelers may also contact Trip Mate directly at 866-389-5378 for specific plan details. </xsl:text>
												</span>
											</td>
										</tr>

									</table>
								</xsl:if>																
								<!--  for insurances:end -->	
							
							<xsl:choose>
								<xsl:when test="($flightsExists='true' and $packageFlightsExists='false')or($hotelsExists='true' and $packageHotelsExists='false')">
									<xsl:if test="(count(/Itinerary/flights/TripFlight) = 1)or(count(/Itinerary/hotels/Hotel) = 1)">	
										<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
										<xsl:variable name="altova:CurrContextGrid_093439B8" select="."/>
										<tbody>
											<tr>
												<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
													<span style="font-weight:bold; ">
														<xsl:text>Price Breakdown</xsl:text>
													</span>
												</td>
											</tr>
										</tbody>
										</table>
										<br/>
										<table style="font-size:12px" border="0" cellPadding="0" cellSpacing="0" width="675">
											<tbody>
												<tr align="left">
													<td style="width:8px; " align="left">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:99px; " align="left">
														<span>
															<xsl:text>Base Price</xsl:text>
														</span>
													</td>
													<td style="width:10px; " align="left">
														<span>
															<xsl:text>:</xsl:text>
														</span>
													</td>
													<td style="width:239px; " align="left">
														<span>
															<xsl:text>$</xsl:text>
														</span>
														<xsl:call-template name="format-price">
															<xsl:with-param name="price">
																<xsl:value-of select="/Itinerary/itineraryPrice/totalPrice - /Itinerary/itineraryPrice/totalTax + /Itinerary/itineraryPrice/promoSavings"/>
															</xsl:with-param>
														</xsl:call-template>
													</td>											
													<td rowspan="5" style="width:319px; " align="right">
													  <table style="background-color:#f5f5f5; border-bottom:#a0a0a4 1px solid; border-left:#a0a0a4 1px solid; border-right:#a0a0a4 1px solid; border-top:#a0a0a4 1px solid; font-size:14px; " align="right" border="0" cellPadding="2" cellSpacing="2" width="270">
															<xsl:variable name="altova:CurrContextGrid_093571D0" select="."/>
															<tbody>
																<tr style="font-weight:bold; ">
																	<td style="width:278px; " align="center">
																		<span>
																			<xsl:text>Total Price: $</xsl:text>
																		</span>
																		<xsl:call-template name="format-price">
																			<xsl:with-param name="price">
																				<xsl:value-of select="/Itinerary/itineraryPrice/totalPrice"/>
																			</xsl:with-param>
																		</xsl:call-template>
																	</td>
																</tr>
																
																<tr style="font-weight:bold; ">
																	<td style="width:278px; " align="center">
																		<span>
																			<xsl:text>Call&#160; </xsl:text>
																		</span>
																		<xsl:value-of select="/Itinerary/bookingHeader/agency/primaryPhone"/>
																		<span>
																			<xsl:text> to Book Now</xsl:text>
																		</span>
																	</td>
																</tr>
															</tbody>
														</table>
													</td>
												</tr>
												<tr>
													<td style="width:8px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:99px; ">
														<span>
															<xsl:text>Commission</xsl:text>
														</span>
													</td>
													<td style="width:10px; ">
														<span>
															<xsl:text>:</xsl:text>
														</span>
													</td>
													<td style="width:239px; ">
														<span>
															<xsl:text>$</xsl:text>
														</span>
														<xsl:call-template name="format-price">
															<xsl:with-param name="price">
																<xsl:value-of select="/Itinerary/bookingHeader/baseCommission"/>
															</xsl:with-param>
														</xsl:call-template>																
													</td>
												</tr>										
												<tr>
													<td style="width:8px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:99px; ">
														<span>
															<xsl:text>Taxes</xsl:text>
														</span>
													</td>
													<td style="width:10px; ">
														<span>
															<xsl:text>:</xsl:text>
														</span>
													</td>
													<td style="width:239px; ">
														<span>
															<xsl:text>$</xsl:text>
														</span>
														<xsl:call-template name="format-price">
															<xsl:with-param name="price">
																<xsl:value-of select="/Itinerary/itineraryPrice/totalTax"/>
															</xsl:with-param>
														</xsl:call-template>
													</td>
												</tr>
												<tr style="height:15px; ">
													<td style="width:8px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:99px; ">
														<span>
															<xsl:text>Total Price</xsl:text>
														</span>
													</td>
													<td style="width:10px; ">
														<span>
															<xsl:text>:</xsl:text>
														</span>
													</td>
													<td style="width:239px; ">
														<span>
															<xsl:text>$</xsl:text>
														</span>
														<xsl:call-template name="format-price">
															<xsl:with-param name="price">
																<xsl:value-of select="/Itinerary/itineraryPrice/totalPrice"/>
															</xsl:with-param>
														</xsl:call-template>
													</td>
												</tr>
		<!-- 										
												<tr style="height:15px; ">
													<td style="width:8px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:99px; ">
														<span>
															<xsl:text>Deposit Due</xsl:text>
														</span>
													</td>
													<td style="width:10px; ">
														<span>
															<xsl:text>:</xsl:text>
														</span>
													</td>
													<td style="width:239px; ">
														<span>
															<xsl:text>$</xsl:text>
														</span>
														<xsl:for-each select="$XML">
															<xsl:for-each select="Itinerary">
																<xsl:for-each select="bookingHeader">
																	<xsl:for-each select="amountDue">
																		<xsl:apply-templates/>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</td>
												</tr>
		-->										
												<tr style="height:15px; ">
													<td style="width:8px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:99px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:10px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:239px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
												</tr>
												<tr style="height:15px; ">
													<td style="width:8px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:99px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:10px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
													<td style="width:239px; ">
														<span>
															<xsl:text> </xsl:text>
														</span>
													</td>
												</tr>
											</tbody>
										</table>
									</xsl:if>
								</xsl:when>
								<xsl:when test="($flightsExists='false' and $packageFlightsExists='true') and ($hotelsExists='false' and $packageHotelsExists='true')">
									<xsl:if test="count(/Itinerary/packages/Package) = 1">	
										<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
										<xsl:variable name="altova:CurrContextGrid_093439B8" select="."/>
										<tbody>
											<tr>
												<td style="background-color:#005e9d; color:#ffffff; font-size:12px; padding-left:5px; ">
													<span style="font-weight:bold; ">
														<xsl:text>Price Breakdown</xsl:text>
													</span>
												</td>
											</tr>
										</tbody>
										</table>
										<br/>
										<table style="font-size:12px" border="0" cellPadding="0" cellSpacing="0" width="675">
										<tbody>
											<tr align="left">
												<td style="width:8px; " align="left">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; " align="left">
													<span>
														<xsl:text>Base Price</xsl:text>
													</span>
												</td>
												<td style="width:10px; " align="left">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; " align="left">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:call-template name="format-price">
														<xsl:with-param name="price">
															<xsl:value-of select="/Itinerary/itineraryPrice/totalPrice - /Itinerary/itineraryPrice/totalTax + /Itinerary/itineraryPrice/promoSavings"/>
														</xsl:with-param>
													</xsl:call-template>
												</td>											
												<td rowspan="5" style="width:319px; " align="right">
												  <table style="background-color:#f5f5f5; border-bottom:#a0a0a4 1px solid; border-left:#a0a0a4 1px solid; border-right:#a0a0a4 1px solid; border-top:#a0a0a4 1px solid; font-size:14px; " align="right" border="0" cellPadding="2" cellSpacing="2" width="270">
														<xsl:variable name="altova:CurrContextGrid_093571D0" select="."/>
														<tbody>
															<tr style="font-weight:bold; ">
																<td style="width:278px; " align="center">
																	<span>
																		<xsl:text>Total Price: $</xsl:text>
																	</span>
																	<xsl:call-template name="format-price">
																		<xsl:with-param name="price">
																			<xsl:value-of select="/Itinerary/itineraryPrice/totalPrice"/>
																		</xsl:with-param>
																	</xsl:call-template>
																</td>
															</tr>
															
															<tr style="font-weight:bold; ">
																<td style="width:278px; " align="center">
																	<span>
																		<xsl:text>Call&#160; </xsl:text>
																	</span>
																	<xsl:value-of select="/Itinerary/bookingHeader/agency/primaryPhone"/>
																	<span>
																		<xsl:text> to Book Now</xsl:text>
																	</span>
																</td>
															</tr>
														</tbody>
													</table>
												</td>
											</tr>
											<tr>
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text>Commission</xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:call-template name="format-price">
														<xsl:with-param name="price">
															<xsl:value-of select="/Itinerary/bookingHeader/baseCommission"/>
														</xsl:with-param>
													</xsl:call-template>																
												</td>
											</tr>										
											<tr>
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text>Taxes</xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:call-template name="format-price">
														<xsl:with-param name="price">
															<xsl:value-of select="/Itinerary/itineraryPrice/totalTax"/>
														</xsl:with-param>
													</xsl:call-template>
												</td>
											</tr>
											<tr style="height:15px; ">
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text>Total Price</xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:call-template name="format-price">
														<xsl:with-param name="price">
															<xsl:value-of select="/Itinerary/itineraryPrice/totalPrice"/>
														</xsl:with-param>
													</xsl:call-template>
												</td>
											</tr>
	<!-- 										
											<tr style="height:15px; ">
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text>Deposit Due</xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text>:</xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text>$</xsl:text>
													</span>
													<xsl:for-each select="$XML">
														<xsl:for-each select="Itinerary">
															<xsl:for-each select="bookingHeader">
																<xsl:for-each select="amountDue">
																	<xsl:apply-templates/>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</td>
											</tr>
	-->										
											<tr style="height:15px; ">
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
											</tr>
											<tr style="height:15px; ">
												<td style="width:8px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:99px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:10px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
												<td style="width:239px; ">
													<span>
														<xsl:text> </xsl:text>
													</span>
												</td>
											</tr>
										</tbody>
										</table>
									</xsl:if>														
								</xsl:when>																											
							</xsl:choose>																	
								<br/>								
								<table style="font-size:12px" border="0" cellPadding="0" cellSpacing="0" width="675">
									<tbody>
										<tr>
											<td colspan="2">
												<span>
													***THE FOLLOWING QUOTE DOES NOT GUARANTEE PRICING OR AVAILABILITY***
												</span>											
											</td>
										</tr>
									</tbody>
								</table>								
								<br/>
								<table style="font-size:12px" border="0" cellPadding="0" cellSpacing="0" width="675">
									<xsl:variable name="altova:CurrContextGrid_09358730" select="."/>
									<tbody>
										<tr>
											<td style="padding-left:10px; " vAlign="top">
												<br/>
												<span>
													<xsl:value-of select="/Itinerary/CustomMessages/ClosingMessage"/>
												</span>
												<br/>
												<span>
													<xsl:text>- </xsl:text>
												</span>
												<xsl:call-template name="agentName">
													<xsl:with-param name="agentFullName">
														<xsl:value-of select="/Itinerary/imApplicationInfo/selectedAgent/fullName" />
													</xsl:with-param>
													<xsl:with-param name="agentFirstName">
	      													<xsl:value-of select="/Itinerary/imApplicationInfo/selectedAgent/firstName" />
	    											</xsl:with-param>
	    											<xsl:with-param name="agentLastName">
	      													<xsl:value-of select="/Itinerary/imApplicationInfo/selectedAgent/lastName" />
	    											</xsl:with-param>
												</xsl:call-template>
											</td>
										</tr>
									</tbody>
								</table>
							</td>
						</tr>
					</tbody>
				</table>
			</body>
		</html>
	</xsl:template>
	<xsl:template name="agentName">
		<xsl:param name="agentFullName"/>
		<xsl:param name="agentFirstName"/>
		<xsl:param name="agentLastName"/>
		<xsl:choose>
			<xsl:when test="$agentFullName='New Agent'">
				<xsl:value-of select="concat($agentFirstName,'',$agentLastName)"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$agentFullName"/>
			</xsl:otherwise>
		</xsl:choose>	
	</xsl:template>
	<xsl:template name="format-price">
	  <xsl:param name="price"/>
	  <xsl:value-of	select="format-number($price, '#,##0.00')"/>
	</xsl:template>	
	<xsl:template name="displayPackageFlightDetails">
		<xsl:param name="tripFlight"/>
		<xsl:call-template name="displayFlight">
			<xsl:with-param name="flight" select="$tripFlight/outboundFlight"/>
			<xsl:with-param name="direction">O</xsl:with-param>
			<xsl:with-param name="guestAllocation" select="$tripFlight/occupancy/noOfAdults+$tripFlight/occupancy/noOfSeniors+$tripFlight/occupancy/noOfChilds+$tripFlight/occupancy/noOfLapChilds+$tripFlight/occupancy/noOfChilds+$tripFlight/occupancy/noOfInfants"/>
		</xsl:call-template>
		<xsl:if test="$tripFlight/inboundFlight">
			<xsl:call-template name="displayFlight">
				<xsl:with-param name="flight" select="$tripFlight/inboundFlight"/>
				<xsl:with-param name="direction">I</xsl:with-param>
				<xsl:with-param name="guestAllocation" select="$tripFlight/occupancy/noOfAdults+$tripFlight/occupancy/noOfSeniors+$tripFlight/occupancy/noOfChilds+$tripFlight/occupancy/noOfLapChilds+$tripFlight/occupancy/noOfChilds+$tripFlight/occupancy/noOfInfants"/>
			</xsl:call-template>
		</xsl:if>	
	</xsl:template>	
	<xsl:template name="displayFlightDetails">
		<xsl:param name="tripFlight"/>
		<xsl:call-template name="displayFlight">
			<xsl:with-param name="flight" select="$tripFlight/outboundFlight"/>
			<xsl:with-param name="direction">O</xsl:with-param>
			<xsl:with-param name="guestAllocation" select="$tripFlight/occupancy/noOfAdults+$tripFlight/occupancy/noOfSeniors+$tripFlight/occupancy/noOfChilds+$tripFlight/occupancy/noOfLapChilds+$tripFlight/occupancy/noOfChilds+$tripFlight/occupancy/noOfInfants"/>
		</xsl:call-template>
		<xsl:if test="$tripFlight/inboundFlight">
			<xsl:call-template name="displayFlight">
				<xsl:with-param name="flight" select="$tripFlight/inboundFlight"/>
				<xsl:with-param name="direction">I</xsl:with-param>
				<xsl:with-param name="guestAllocation" select="$tripFlight/occupancy/noOfAdults+$tripFlight/occupancy/noOfSeniors+$tripFlight/occupancy/noOfChilds+$tripFlight/occupancy/noOfLapChilds+$tripFlight/occupancy/noOfChilds+$tripFlight/occupancy/noOfInfants"/>
			</xsl:call-template>
		</xsl:if>		
		<xsl:if test="$tripFlight/price">
			<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
				<tbody>
					<tr style="background-color:#cacaca; font-weight:bold; ">
						<td style="width:110px; ">
							<span>
								<xsl:text>Passenger Type</xsl:text>
							</span>
						</td>
						<td style="width:110px; ">
							<span>
								<xsl:text>Price per Passenger</xsl:text>
							</span>
						</td>						  							
						<td style="width:110px; " align="center">
							<span>
								<xsl:text>Taxes</xsl:text>
							</span>
						</td>						
						<td style="width:110px; ">
							<span>
								<xsl:text>US Tax</xsl:text>
							</span>
						</td>
						<td style="width:110px; ">
							<span>
								<xsl:text>Foreign Tax</xsl:text>
							</span>
						</td>
						<td style="width:110px; ">
							<span>
								<xsl:text>Airport Fee</xsl:text>
							</span>
						</td>
						<td style="width:110px; ">
							<span>
								<xsl:text>Total Price Per Person</xsl:text>
							</span>
						</td>
						<td style="width:110px; ">
							<span>
								<xsl:text>Total Price</xsl:text>
							</span>
						</td>
					</tr>												
				</tbody>						
		    <xsl:for-each select="$tripFlight/price/paxTypePriceBreakups/com.kcdata.abe.data.dto.PaxTypePriceBreakup">	 	
		 		<tr>
					<td style="width:110px; ">
						<xsl:if test="paxType = 'A'">
							Adult 
						</xsl:if>
						<xsl:if test="paxType = 'C'">
							Child 
						</xsl:if>
						<xsl:if test="paxType = 'L'">
							LapChild 
						</xsl:if>
						<xsl:if test="paxType = 'D'">
							Junior 
						</xsl:if>			
						<xsl:value-of select="count"/>	
					</td>
					<td style="width:110px; ">
						$<xsl:value-of select="format-number(price, '#,##0.00')"/>	
					</td>
					<td style="width:110px; ">
						$<xsl:value-of select="format-number(taxes, '#,##0.00')"/>	
					</td>
					<td style="width:110px; ">
						$<xsl:value-of select="format-number(usTax, '#,##0.00')"/>	
					</td>
					<td style="width:110px; ">
						$<xsl:value-of select="format-number(foreignTax, '#,##0.00')"/>	
					</td>
					<td style="width:110px; ">
						$<xsl:value-of select="format-number(airportTax, '#,##0.00')"/>	
					</td>
					<td style="width:110px; ">
						$<xsl:value-of select="format-number(price+taxes, '#,##0.00')"/>	
					</td>
					<td style="width:110px; ">
						$<xsl:value-of select="format-number(totalAmount, '#,##0.00')"/>	
					</td>
				</tr>
			</xsl:for-each>
		 </table>					
		</xsl:if>				
		<br/>				
	</xsl:template>
	<xsl:template name="displayFlight">
		<xsl:param name="flight"/>
		<xsl:param name="direction"/>
		<xsl:param name="guestAllocation"/>
		<table style="font-size:12px" border="0" cellPadding="2" cellSpacing="2" width="675">
			<tbody>
				<xsl:for-each select="$flight/flightSegments/FlightSegment">
					<tr style="background-color:#f5f5f5; " align="center" vAlign="middle">
						<xsl:if test="position() = 1">
						<td style="width:88px; ">
							<xsl:attribute name="rowspan">
								<xsl:value-of select="$flight/noOfStops + 1"/>
							</xsl:attribute>
							<span style="font-weight:bold; ">
								<xsl:choose>
									<xsl:when test="$direction='O'">
										<xsl:text>Departing </xsl:text>
									</xsl:when>
									<xsl:otherwise>
										<xsl:text>Returning </xsl:text>
									</xsl:otherwise>
								</xsl:choose>
								<xsl:text>Flight(s):</xsl:text>
							</span>
							<br/>
							<xsl:variable name="stops" select="$flight/noOfStops" />
							<xsl:choose>
								<xsl:when test="not($stops='0')">
									<xsl:value-of select="$stops" />
									<span>
										<xsl:text> Connection(s)</xsl:text>
									</span>
								</xsl:when>
								<xsl:otherwise>
									 Non Stop
								</xsl:otherwise>
							</xsl:choose>
							<br/>
						</td>
						<td style="width:77px; ">
							<xsl:attribute name="rowspan">
								<xsl:value-of select="$flight/noOfStops + 1"/>
							</xsl:attribute>				
							<xsl:value-of select="$guestAllocation"/>
						</td>
						</xsl:if>
						<td style="width:97px; ">						
							<xsl:variable name="codeShareCarrier" select="codeShareCarrier" />						
							<xsl:variable name="flightNo" select="flightNo" />						
							<xsl:choose>
								<xsl:when test="count(codeShareCarrier)>0">
									
										<xsl:value-of select="codeShareCarrier/carrierName" />											
												<span>
													<xsl:text> #</xsl:text>
												 </span>	
												 <xsl:value-of select="$flightNo"/>	
												 <br/>										
												<span>
													<xsl:text> *Operated by </xsl:text>
												 </span>				
										<xsl:value-of select="carrier/carrierName" />
											
								</xsl:when>
								<xsl:otherwise>									
										<xsl:value-of select="carrier/carrierName" />
											
												 <span>
													<xsl:text> #</xsl:text>
												 </span>	
												 <xsl:value-of select="$flightNo"/>
									
								</xsl:otherwise>
							</xsl:choose>
							<br/>													
								<xsl:if test="count(recordLocator)>0">									
									<span>
										<xsl:text> Record Locator </xsl:text>
									</span>						   
									<xsl:value-of select="recordLocator"/>
								</xsl:if>																					
						</td>						
						<td style="width:120px; ">						
							<span style="font-weight:bold; ">
								<xsl:call-template name="FormatDateYYYY-MM-DDHHMM">
									<xsl:with-param name="DateTime" select="departureDate"/>
								</xsl:call-template>
							</span>
							<br/>
							<span style="font-weight:bold; ">
								<xsl:value-of select="gateway"/>
							</span>
						</td>
						<td style="width:120px; ">
							<span style="font-weight:bold; ">
								<xsl:call-template name="FormatDateYYYY-MM-DDHHMM">
									<xsl:with-param name="DateTime" select="arrivalDate"/>
								</xsl:call-template>
							</span>
							<br/>
							<span style="font-weight:bold; ">
								<xsl:value-of select="destination"/>
							</span>
						</td>
						<td style="width:65px; ">
							<span style="font-weight:bold; ">
								<xsl:value-of select="classOfService"/>
							</span>
						</td>						
					</tr>
				</xsl:for-each>				
			</tbody>
		</table>
	</xsl:template>
	<xsl:template name="checkFlightsExists">
		<xsl:choose>
			<xsl:when test="count(/Itinerary/flights/TripFlight) > 0">
				<xsl:text>true</xsl:text>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>false</xsl:text>
			</xsl:otherwise>			
		</xsl:choose>
	</xsl:template>
	<xsl:template name="checkHotelsExists">
		<xsl:choose>
			<xsl:when test="count(/Itinerary/hotels/Hotel) > 0">
				<xsl:text>true</xsl:text>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>false</xsl:text>
			</xsl:otherwise>			
		</xsl:choose>
	</xsl:template>	
	<xsl:template name="checkPackageFlightsExists">
		<xsl:choose>
			<xsl:when test="count(/Itinerary/packages/Package/selectedFlight) > 0">
				<xsl:text>true</xsl:text>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>false</xsl:text>
			</xsl:otherwise>			
		</xsl:choose>
	</xsl:template>		
	<xsl:template name="checkPackageHotelsExists">
		<xsl:choose>
			<xsl:when test="count(/Itinerary/packages/Package/selectedHotel) > 0">
				<xsl:text>true</xsl:text>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>false</xsl:text>
			</xsl:otherwise>			
		</xsl:choose>
	</xsl:template>		
	<xsl:template name="displayHotel">
		<xsl:param name="hotel"/>		
		 <tr>
			<td style="text-align:center; width:90px; ">
				<xsl:value-of select="$hotel/occupancy/noOfAdults+$hotel/occupancy/noOfSeniors+$hotel/occupancy/noOfChilds+$hotel/occupancy/noOfLapChilds+$hotel/occupancy/noOfChilds+$hotel/occupancy/noOfInfants"/>
			</td>
			<td style="width:238px; ">
			<table border="0" cellPadding="0" cellSpacing="0" width="199">			
				<tr>
				<td> 			 
				<img style="width:60px; height:60px;">
					<xsl:attribute name="src">
						<xsl:text>http://www.applevacations.com/appleweb/images/hotels/</xsl:text>
						<xsl:value-of select='translate($hotel/hotelCityCode, $uppercase, $smallcase)'/>
						<xsl:text>_</xsl:text>
						<xsl:value-of select="number($hotel/hotelCode)"/>
						<xsl:text>paa_t.jpg</xsl:text>
					</xsl:attribute>
				</img>		
			   </td>
			   <td style="font-size:12px; width:122px; ">
				<a style=" font-size:12px; font-weight:bold; " target="_blank">
					<xsl:attribute name="href">
						<xsl:text>http://www.applevacations.com/showHotel.do?command=showHotel&amp;display=1&amp;hotelCode=</xsl:text>
						<xsl:value-of select='number($hotel/hotelCode)'/>
					</xsl:attribute>
					<xsl:value-of select="$hotel/hotelName"/>
				</a>
				<br/>			
				<img>
					<xsl:attribute name="src">
						<xsl:text>http://www.applevacations.com/appleweb/images/SpecialApple/</xsl:text>
						<xsl:value-of select="substring($hotel/appleRating, 1, 1)"/>
						<xsl:choose>
							<xsl:when test='string-length($hotel/appleRating)=1'>
								<xsl:text>_Apple.gif</xsl:text>																			
							</xsl:when>
							<xsl:when test='substring($hotel/appleRating, 2, 1)="P"'>
								<xsl:text>_G_plus.gif</xsl:text>																			
							</xsl:when>																		
							<xsl:when test='substring($hotel/appleRating, 2, 1)="+"'>
								<xsl:text>_A_plus.gif</xsl:text>																			
							</xsl:when>																		
							<xsl:when test='substring($hotel/appleRating, 2, 1)="G"'>
								<xsl:text>_Golden_Apple.gif</xsl:text>																			
							</xsl:when>
						</xsl:choose>
					</xsl:attribute>
				</img>				
				</td>
				</tr>				
			</table>
			</td>
			<td style="text-align:center;width:75px; ">
				<xsl:value-of select="$hotel/noOfNights"/>
			</td>
			<td style="text-align:center;width:169px; ">
				<xsl:value-of select="$hotel/displayRoomCategory/roomTypeDescription"/>
			</td>
			<td style="width:110px; ">
				<xsl:call-template name="FormatDateYYYY-MM-DD">
					<xsl:with-param name="DateTime" select="$hotel/checkInDate"/>
				</xsl:call-template>
			</td>
			<td style="width:110px; ">
				<xsl:call-template name="FormatDateYYYY-MM-DD">
					<xsl:with-param name="DateTime" select="$hotel/checkOutDate"/>
				</xsl:call-template>
			</td>
			<td style="width:110px; ">
				<xsl:value-of select="$hotel/roomCategories/RoomCategory/mealplanDesc"/>	
			</td>
		</tr>
		<xsl:if test="$hotel/preselectedRooms/object-array/RoomPrice or $hotel/selectedRooms/object-array/RoomPrice">					
		<tbody>	
		<tr style="background-color:#cacaca; font-weight:bold; ">
			<td style="width:70px; " align="center">
				<span>
					<xsl:text>Room</xsl:text>
				</span>
			</td>
			<td style="width:110px; ">
				<span>
					<xsl:text>Passenger Type</xsl:text>
				</span>
			</td>
			<td style="width:110px; ">
				<span>
					<xsl:text>Price per Passenger</xsl:text>
				</span>
			</td>								
			<td style="width:110px; " align="center">
				<span>
					<xsl:text>Taxes</xsl:text>
				</span>
			</td>
			<td style="width:110px; ">
				<span>
					<xsl:text>US Tax</xsl:text>
				</span>
			</td>
			<td style="width:110px; ">
				<span>
					<xsl:text>Foreign Tax</xsl:text>
				</span>
			</td>
			<td style="width:110px; ">
				<span>
					<xsl:text>Airport Fee</xsl:text>
				</span>
			</td>
			<td style="width:110px; ">
				<span>
					<xsl:text>Total Price Per Person</xsl:text>
				</span>
			</td>
			<td style="width:110px; ">
				<span>
					<xsl:text>Total Price</xsl:text>
				</span>
			</td>
		</tr>
		</tbody>													
		<xsl:choose>
		<xsl:when test="$hotel/preselectedRooms/object-array/RoomPrice">
			<xsl:for-each select="$hotel/preselectedRooms/object-array/RoomPrice">
				<xsl:call-template name="paxRoomPriceDetails">
					<xsl:with-param name="paxRoomId" select="roomId"/>
					<xsl:with-param name="isPkgHotel" select="false()" />
					<xsl:with-param name="paxRoomPrice" select="."/>
				</xsl:call-template>								
			</xsl:for-each>
		</xsl:when>
		<xsl:when test="$hotel/selectedRooms/object-array/RoomPrice">
			<xsl:for-each select="$hotel/selectedRooms/object-array/RoomPrice">
				<xsl:call-template name="paxRoomPriceDetails">
					<xsl:with-param name="paxRoomId" select="roomId"/>
					<xsl:with-param name="isPkgHotel" select="false()" />
					<xsl:with-param name="paxRoomPrice" select="."/>
				</xsl:call-template>								
			</xsl:for-each>								
		</xsl:when>					
		</xsl:choose>		
		</xsl:if>
		<br/>
	</xsl:template>
	
	<xsl:template name="displayPackageHotel">
	<xsl:param name="hotel"/>		
	 <tr>
		<td style="text-align:center; width:90px; ">
			<xsl:value-of select="$hotel/occupancy/noOfAdults+$hotel/occupancy/noOfSeniors+$hotel/occupancy/noOfChilds+$hotel/occupancy/noOfLapChilds+$hotel/occupancy/noOfChilds+$hotel/occupancy/noOfInfants"/>
		</td>
		<td style="width:238px; ">
		<table border="0" cellPadding="0" cellSpacing="0" width="199">			
			<tr>
			<td>			 
			<img style="width:60px; height:60px;">
				<xsl:attribute name="src">
					<xsl:text>http://www.applevacations.com/appleweb/images/hotels/</xsl:text>
					<xsl:value-of select='translate($hotel/hotelCityCode, $uppercase, $smallcase)'/>
					<xsl:text>_</xsl:text>
					<xsl:value-of select="number($hotel/hotelCode)"/>
					<xsl:text>paa_t.jpg</xsl:text>
				</xsl:attribute>
			</img>		
		   </td>
		   <td style="font-size:12px; width:122px; ">
			<a style="font-size:12px; font-weight:bold; " target="_blank">
				<xsl:attribute name="href">
					<xsl:text>http://www.applevacations.com/showHotel.do?command=showHotel&amp;display=1&amp;hotelCode=</xsl:text>
					<xsl:value-of select='number($hotel/hotelCode)'/>
				</xsl:attribute>
				<xsl:value-of select="$hotel/hotelName"/>
			</a>
			<br/>			
			<img>
				<xsl:attribute name="src">
					<xsl:text>http://www.applevacations.com/appleweb/images/SpecialApple/</xsl:text>
					<xsl:value-of select="substring($hotel/appleRating, 1, 1)"/>
					<xsl:choose>
						<xsl:when test='string-length($hotel/appleRating)=1'>
							<xsl:text>_Apple.gif</xsl:text>																			
						</xsl:when>
						<xsl:when test='substring($hotel/appleRating, 2, 1)="P"'>
							<xsl:text>_G_plus.gif</xsl:text>																			
						</xsl:when>																		
						<xsl:when test='substring($hotel/appleRating, 2, 1)="+"'>
							<xsl:text>_A_plus.gif</xsl:text>																			
						</xsl:when>																		
						<xsl:when test='substring($hotel/appleRating, 2, 1)="G"'>
							<xsl:text>_Golden_Apple.gif</xsl:text>																			
						</xsl:when>
					</xsl:choose>
				</xsl:attribute>
			</img>				
			</td>
			</tr>				
		</table>
		</td>
		<td style="text-align:center;width:75px; ">
			<xsl:value-of select="$hotel/noOfNights"/>
		</td>
		<td style="text-align:center;width:169px; ">
			<xsl:value-of select="$hotel/displayRoomCategory/roomTypeDescription"/>
		</td>
		<td style="width:110px; ">
			<xsl:call-template name="FormatDateYYYY-MM-DD">
				<xsl:with-param name="DateTime" select="$hotel/checkInDate"/>
			</xsl:call-template>
		</td>
		<td style="width:110px; ">
			<xsl:call-template name="FormatDateYYYY-MM-DD">
				<xsl:with-param name="DateTime" select="$hotel/checkOutDate"/>
			</xsl:call-template>
		</td>
		<td style="width:110px; ">
			<xsl:value-of select="$hotel/roomCategories/RoomCategory/mealplanDesc"/>	
		</td>
	</tr>		
	<br/>
	</xsl:template>
	
	<xsl:template name="checkVehiclesExists">
		<xsl:choose>
			<xsl:when test="count(/Itinerary/vehicles/Vehicle) > 0">
				<xsl:text>true</xsl:text>
			</xsl:when>
			<xsl:when test="count(/Itinerary/packages/Package/selectedVehicle) > 0">
				<xsl:text>true</xsl:text>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>false</xsl:text>
			</xsl:otherwise>			
		</xsl:choose>
	</xsl:template>	
	<xsl:template name="displayVehicle">
		<xsl:param name="vehicle"/>
		<tr>
			<td style="text-align:center; width:86px; ">
				<xsl:value-of select="$vehicle/guestAllocation"/>
			</td>
			<td style="width:70px; ">
				<xsl:value-of select="$vehicle/companyDescription"/>
			</td>
			<td style="width:188px; ">
				<xsl:value-of select="$vehicle/description"/>
			</td>
			<td style="width:79px; ">
				<xsl:value-of select="$vehicle/vehicleClass"/>
			</td>
			<td style="width:110px; ">
				<xsl:value-of select="$vehicle/pickupLocation"/>
				<br/>
				<xsl:call-template name="FormatDateYYYY-MM-DDHHMM">
					<xsl:with-param name="DateTime" select="$vehicle/pickupTime"/>
				</xsl:call-template>
			</td>
			<td style="width:110px; ">
				<xsl:value-of select="$vehicle/dropOffLocation"/>
				<br/>
				<xsl:call-template name="FormatDateYYYY-MM-DDHHMM">
					<xsl:with-param name="DateTime" select="$vehicle/dropOffTime"/>
				</xsl:call-template>
			</td>
		</tr>
	</xsl:template>
    <xsl:template name="FormatDateYYYY-MM-DDHHMM">
	    <xsl:param name="DateTime" />
	    <!-- new date format 2010-10-13 00:00:00.0 EDT -->
	    <xsl:variable name="year">
	      <xsl:value-of select="substring($DateTime,1,4)" />
	    </xsl:variable>
	    <xsl:variable name="mo">
	      <xsl:value-of select="substring($DateTime,6,2)" />
	    </xsl:variable>
	    <xsl:variable name="day">
	      <xsl:value-of select="substring($DateTime,9,2)" />
	    </xsl:variable>
	    <xsl:variable name="hh">
	      <xsl:value-of select="substring($DateTime,12,2)" />
	    </xsl:variable>
	    <xsl:variable name="mm">
	      <xsl:value-of select="substring($DateTime,15,2)" />
	    </xsl:variable>
	    <xsl:variable name="ss">
	      <xsl:value-of select="substring($DateTime,18,2)" />
	    </xsl:variable>	   
	    <xsl:value-of select="$year"/>
	    <xsl:text>-</xsl:text>
	    <xsl:value-of select="$mo"/>
	    <xsl:text>-</xsl:text>
	    <xsl:value-of select="$day"/>
	    <xsl:text> </xsl:text>
	    <xsl:choose>
	    	<xsl:when test="$hh='00'">
	    		<xsl:text>12</xsl:text>
	    	</xsl:when>
	    	<xsl:when test="$hh &gt; '12'">
	    		<xsl:value-of select="number($hh) - 12"/>
	    	</xsl:when>
	    	<xsl:otherwise>
	    		<xsl:value-of select="$hh"/>
	    	</xsl:otherwise>
	    </xsl:choose>	    
	    <xsl:text>:</xsl:text>
	    <xsl:value-of select="$mm"/>
	    <xsl:text> </xsl:text>
	    <xsl:choose>
	    	<xsl:when test="$hh &lt; '12'">
	    		<xsl:text>AM</xsl:text>
	    	</xsl:when>
	    	<xsl:otherwise>
	    		<xsl:text>PM</xsl:text>
	    	</xsl:otherwise>
	    </xsl:choose>
	</xsl:template>
    <xsl:template name="FormatDateYYYY-MM-DD">
	    <xsl:param name="DateTime" />
	    <!-- new date format 2010-10-13 00:00:00.0 EDT -->
	    <xsl:variable name="year">
	      <xsl:value-of select="substring($DateTime,1,4)" />
	    </xsl:variable>
	    <xsl:variable name="mo">
	      <xsl:value-of select="substring($DateTime,6,2)" />
	    </xsl:variable>
	    <xsl:variable name="day">
	      <xsl:value-of select="substring($DateTime,9,2)" />
	    </xsl:variable>
	    <xsl:variable name="hh">
	      <xsl:value-of select="substring($DateTime,12,2)" />
	    </xsl:variable>
	    <xsl:variable name="mm">
	      <xsl:value-of select="substring($DateTime,15,2)" />
	    </xsl:variable>
	    <xsl:variable name="ss">
	      <xsl:value-of select="substring($DateTime,18,2)" />
	    </xsl:variable>	   
	    <xsl:value-of select="$year"/>	    
	    <xsl:text>-</xsl:text>
	    <xsl:value-of select="$mo"/>
	    <xsl:text>-</xsl:text>
	    <xsl:value-of select="$day"/>	     
	</xsl:template>	
	<xsl:template name="paxRoomPriceDetails">
		<xsl:param name="paxRoomPrice"/>
		<xsl:param name="paxRoomId"/>
		<xsl:param name="isPkgHotel"/>
		<xsl:call-template name="paxRoomPriceDisplay">
			<xsl:with-param name="paxTypePrice" select="$paxRoomPrice/paxTypePriceBreakups/object-array"/>
			<xsl:with-param name="paxRoomIdValue" select="$paxRoomId" />
			<xsl:with-param name="isPkgHotelValue" select="$isPkgHotel"/>
		</xsl:call-template>
	</xsl:template>	
	<xsl:template name="paxRoomPriceDisplay">
		<xsl:param name="paxTypePrice"/>
		<xsl:param name="paxRoomIdValue"/>	
		<xsl:param name="isPkgHotelValue"/>	
		<xsl:for-each select="$paxTypePrice/com.kcdata.abe.data.dto.PaxTypePriceBreakup">
		<tr style="font-size:12px" >
			<td style="width:70px; ">
				<xsl:value-of select="$paxRoomIdValue"/>	
			</td>
			<td style="width:110px; ">
				<xsl:if test="paxType = 'A'">
					Adult 
				</xsl:if>
				<xsl:if test="paxType = 'C'">
					Child 
				</xsl:if>
				<xsl:if test="paxType = 'L'">
					LapChild 
				</xsl:if>
				<xsl:if test="paxType = 'D'">
					Junior 
				</xsl:if>			
				<xsl:value-of select="count"/>	
			</td>
			<td style="width:110px; ">
				$<xsl:value-of select="format-number(price, '#,##0.00')"/>	
			</td>
			<td style="width:110px; ">
				$<xsl:value-of select="format-number(taxes, '#,##0.00')"/>	
			</td>
			<td style="width:110px; ">
				$<xsl:value-of select="format-number(usTax, '#,##0.00')"/>	
			</td>
			<td style="width:110px; ">
				$<xsl:value-of select="format-number(foreignTax, '#,##0.00')"/>	
			</td>
			<td style="width:110px; ">
				$<xsl:value-of select="format-number(airportTax, '#,##0.00')"/>	
			</td>
			<td style="width:110px; ">
				$<xsl:value-of select="format-number(price+taxes, '#,##0.00')"/>	
			</td>
			<xsl:if test="$isPkgHotelValue = true()">
				<td style="width:110px; ">
					$<xsl:value-of select="format-number(totalAmount*count, '#,##0.00')"/>	
				</td>
			</xsl:if>
			<xsl:if test="$isPkgHotelValue = false()">
				<td style="width:110px; ">
					$<xsl:value-of select="format-number(totalAmount, '#,##0.00')"/>	
				</td>
			</xsl:if>
		 </tr>							
		</xsl:for-each>	
	</xsl:template>
	<xsl:template name="FormatDateMMDD">
	    <xsl:param name="DateTime" />
	    <!-- new date format 2010-10-13 00:00:00.0 EDT -->
	    <xsl:variable name="year">
	      <xsl:value-of select="substring($DateTime,1,4)" />
	    </xsl:variable>
	    <xsl:variable name="mo">
	      <xsl:value-of select="substring($DateTime,6,2)" />
	    </xsl:variable>
	    <xsl:variable name="day">
	      <xsl:value-of select="substring($DateTime,9,2)" />
	    </xsl:variable>
	    <xsl:variable name="hh">
	      <xsl:value-of select="substring($DateTime,12,2)" />
	    </xsl:variable>
	    <xsl:variable name="mm">
	      <xsl:value-of select="substring($DateTime,15,2)" />
	    </xsl:variable>
	    <xsl:variable name="ss">
	      <xsl:value-of select="substring($DateTime,18,2)" />
	    </xsl:variable>	   
	    <xsl:value-of select="$mo"/>
	    <xsl:text>/</xsl:text>
	    <xsl:value-of select="$day"/>	     
	</xsl:template>
</xsl:stylesheet>